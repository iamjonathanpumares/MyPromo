{% extends 'base_home.html' %}
{% load staticfiles %}
{% block styles_tags %}
	<title>Agregar locales</title>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">

    <!-- Bootstrap core CSS -->
    <link href="{% static "css/bootstrap.css" %}" rel="stylesheet">
    <!--external css-->
    <link href="{% static "font-awesome/css/font-awesome.css" %}" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="{% static "css/zabuto_calendar.css" %}">
    <link rel="stylesheet" type="text/css" href="{% static "js/gritter/css/jquery.gritter.css" %}" />
    <link rel="stylesheet" type="text/css" href="{% static "lineicons/style.css" %}">    
    
    <!-- Custom styles for this template -->
    <link href="{% static "css/style.css" %}" rel="stylesheet">
    <link href="{% static "css/style-responsive.css" %}" rel="stylesheet">
    <script src="http://code.jquery.com/jquery-latest.js"></script>
   
    <script src="{% static "js/chart-master/Chart.js" %}"></script>
    <style>
        #myMap {
           height: 350px;
           width: 680px;
        }
        .fila-base
        {
          display: none;
        }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script type="text/javascript"> 
            var map;
            var marker;
            var myLatlng = new google.maps.LatLng(19.847575941160585,-90.53628740325325);
            var geocoder = new google.maps.Geocoder();
            var infowindow = new google.maps.InfoWindow();
            function initialize(){
                var mapOptions = {
                    zoom: 18,
                    center: myLatlng,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
               
                map = new google.maps.Map(document.getElementById("myMap"), mapOptions);
                
                marker = new google.maps.Marker({
                    map: map,
                    position: myLatlng,
                    draggable: true 
                });     
                
                geocoder.geocode({'latLng': myLatlng }, function(results, status) {
                    if (status == google.maps.GeocoderStatus.OK) {
                        if (results[0]) {
                            $('#direccion').val(results[0].formatted_address);
                            $('#latitud').val(marker.getPosition().lat());
                            $('#longitud').val(marker.getPosition().lng());
                            infowindow.setContent(results[0].formatted_address);
                            infowindow.open(map, marker);
                        }
                    }
                });

                               
                google.maps.event.addListener(marker, 'dragend', function() {

                geocoder.geocode({'latLng': marker.getPosition()}, function(results, status) {
                    if (status == google.maps.GeocoderStatus.OK) {
                        if (results[0]) {
                            $('#direccion').val(results[0].formatted_address);
                            $('#latitud').val(marker.getPosition().lat());
                            $('#longitud').val(marker.getPosition().lng());
                            infowindow.setContent(results[0].formatted_address);
                            infowindow.open(map, marker);
                        }
                    }
                });
            });
            
            }
            
            google.maps.event.addDomListener(window, 'load', initialize);
        </script>
{% endblock styles_tags %}

{% block menu_inicio %} 
<li class="mt">
    <a href="/home/">
        <i class="fa fa-home"></i>
        <span>Inicio</span>
    </a>
</li>
{% endblock menu_inicio %}

{% block menu_afiliados %}
<li class="sub-menu">
    <a class="active" href="javascript:;" >
        <i class="fa fa-briefcase"></i>
        <span>Afiliados</span>
    </a>
    <ul class="sub">
        <li><a href ="/agregar-afiliados/"> &nbsp;&nbsp;&nbsp;<i class="fa fa-plus"></i>Agregar</a></li>
         <li class="active"><a href ="/lista-afiliados/"> &nbsp;&nbsp;&nbsp;<i class="fa fa-edit"></i>Modificar</a></li>
        
    </ul>
</li>
{% endblock menu_afiliados %}

{% block section %}
    <h3><i class="fa fa-angle-right"></i> Locales actuales</h3>
    <div class="form-panel">
      <table class="table table-striped table-advance table-hover">
        <h4><i class="fa fa-angle-right"></i> Tabla de locales</h4>
        <div class="col-md-4">
          <div class="input-group">
            <input type="text" class="form-control" placeholder="Buscar...">
            <span class="input-group-addon"><i class="fa fa-search"></i></span>
          </div>
        </div>
        <hr>
        <thead> 
        <tr>
            <th class="hidden-phone"><i class="fa fa-home"></i> Dirección</th>
            <th><i class="fa fa-location-arrow"></i> Latitud</th>
            <th><i class=" fa fa-location-arrow"></i> Longitud</th>
            <th></th>
        </tr>
        </thead>
        <tbody class="TableBodyUpdate">
          {% for local in locales %}
          <tr class="TableBodyUpdate-row">
            <td class="hidden-phone TableBodyUpdate-data TableBodyUpdate--direccion">{{ local.direccion }}</td>
            <td class="TableBodyUpdate-data TableBodyUpdate--latitud">{{ local.latitud }}</td>
            <td class="TableBodyUpdate-data TableBodyUpdate--longitud">{{ local.longitud }}</td>
            <td class="TableBodyUpdate-data TableBodyUpdate--eliminar">
                <button class="btn btn-danger btn-xs"><i class="fa fa-trash-o "></i></button>
            </td>
          </tr>
          {% empty %}
            <tr class="TableBodyUpdate-row">
              <td class="hidden-phone TableBodyUpdate-data TableBodyUpdate--direccion">No hay locales para mostrar</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <h3><i class="fa fa-angle-right"></i> Agregar locales</h3>
    <div id="myMap"></div><br/>

    <div>
      <input id="direccion"  type="text" style="width:600px;"/>
      <button id="agregar-local" class="btn btn-danger btn-xs boton"><i class="fa"></i>Agregar local</button>
      <br/>
      <input type="text" id="latitud" placeholder="Latitude" style="display: none;"/>
      <input type="text" id="longitud" placeholder="Longitude" style="display: none;"/>
      <br>
    </div>
    {% csrf_token %}
    <button id="enviar-locales" name="btn-enviar-locales">Guardar</button>
            
    <div class="form-panel">
      <table class="table table-striped table-advance table-hover">
        <h4><i class="fa fa-angle-right"></i> Tabla de nuevos locales</h4>
        <div class="col-md-4">
          <div class="input-group">
            <input type="text" class="form-control" placeholder="Buscar...">
            <span class="input-group-addon"><i class="fa fa-search"></i></span>
          </div>
        </div>
        <hr>
        <thead> 
        <tr>
            <th class="hidden-phone"><i class="fa fa-home"></i> Dirección</th>
            <th><i class="fa fa-location-arrow"></i> Latitud</th>
            <th><i class=" fa fa-location-arrow"></i> Longitud</th>
            <th></th>
        </tr>
        </thead>
        <tbody class="TableBody">
          <tr class="TableBody-row fila-base">
            <td class="hidden-phone TableBody-data TableBody--direccion">12345</td>
            <td class="TableBody-data TableBody--latitud">Quijano Villamil</td>
            <td class="TableBody-data TableBody--longitud">Pablo</td>
            <td class="TableBody-data TableBody--eliminar">
                <button class="btn btn-danger btn-xs"><i class="fa fa-trash-o "></i></button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

                           
{% endblock section %}
{% block scripts_tags %}
  <script type="text/javascript" src="{% static "js/local.js" %}"></script>
{% endblock scripts_tags %}